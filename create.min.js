/*!
 * @overview RSVP - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/tildeio/rsvp.js/master/LICENSE
 * @version   3.0.18
 */

(function(){"use strict";function t(t){return"function"==typeof t||"object"==typeof t&&null!==t}function n(t){return"function"==typeof t}function e(t){return"object"==typeof t&&null!==t}function r(){}function o(t,n){for(var e=0,r=t.length;e<r;e++)if(t[e]===n)return e;return-1}function i(t){var n=t._promiseCallbacks;return n||(n=t._promiseCallbacks={}),n}function u(t,n){return"onerror"===t?void yt.on("error",n):2!==arguments.length?yt[t]:void(yt[t]=n)}function a(){setTimeout(function(){for(var t,n=0;n<mt.length;n++){t=mt[n];var e=t.payload;e.guid=e.key+e.id,e.childGuid=e.key+e.childId,e.error&&(e.stack=e.error.stack),yt.trigger(t.name,t.payload)}mt.length=0},50)}function c(t,n,e){1===mt.push({name:t,payload:{key:n._guidKey,id:n._id,eventName:t,detail:n._result,childId:e&&e._id,label:n._label,timeStamp:dt(),error:yt["instrument-with-stack"]?new Error(n._label):null}})&&a()}function s(){return new TypeError("A promises callback cannot return that same promise.")}function f(){}function l(t){try{return t.then}catch(t){return jt.error=t,jt}}function p(t,n,e,r){try{t.call(n,e,r)}catch(t){return t}}function h(t,n,e){yt.async(function(t){var r=!1,o=p(e,n,function(e){r||(r=!0,n!==e?v(t,e):m(t,e))},function(n){r||(r=!0,w(t,n))},"Settle: "+(t._label||" unknown promise"));!r&&o&&(r=!0,w(t,o))},t)}function d(t,n){n._state===bt?m(t,n._result):n._state===Et?(n._onError=null,w(t,n._result)):g(n,void 0,function(e){n!==e?v(t,e):m(t,e)},function(n){w(t,n)})}function _(t,e){if(e.constructor===t.constructor)d(t,e);else{var r=l(e);r===jt?w(t,jt.error):void 0===r?m(t,e):n(r)?h(t,e,r):m(t,e)}}function v(n,e){n===e?m(n,e):t(e)?_(n,e):m(n,e)}function y(t){t._onError&&t._onError(t._result),b(t)}function m(t,n){t._state===gt&&(t._result=n,t._state=bt,0===t._subscribers.length?yt.instrument&&wt("fulfilled",t):yt.async(b,t))}function w(t,n){t._state===gt&&(t._state=Et,t._result=n,yt.async(y,t))}function g(t,n,e,r){var o=t._subscribers,i=o.length;t._onError=null,o[i]=n,o[i+bt]=e,o[i+Et]=r,0===i&&t._state&&yt.async(b,t)}function b(t){var n=t._subscribers,e=t._state;if(yt.instrument&&wt(e===bt?"fulfilled":"rejected",t),0!==n.length){for(var r,o,i=t._result,u=0;u<n.length;u+=3)r=n[u],o=n[u+e],r?A(e,r,o,i):o(i);t._subscribers.length=0}}function E(){this.error=null}function j(t,n){try{return t(n)}catch(t){return At.error=t,At}}function A(t,e,r,o){var i,u,a,c,f=n(r);if(f){if(i=j(r,o),i===At?(c=!0,u=i.error,i=null):a=!0,e===i)return void w(e,s())}else i=o,a=!0;e._state!==gt||(f&&a?v(e,i):c?w(e,u):t===bt?m(e,i):t===Et&&w(e,i))}function T(t,n){var e=!1;try{n(function(n){e||(e=!0,v(t,n))},function(n){e||(e=!0,w(t,n))})}catch(n){w(t,n)}}function C(t,n,e){return t===bt?{state:"fulfilled",value:e}:{state:"rejected",reason:e}}function k(t,n,e,r){var o=this;o._instanceConstructor=t,o.promise=new t(f,r),o._abortOnReject=e,o._validateInput(n)?(o._input=n,o.length=n.length,o._remaining=n.length,o._init(),0===o.length?m(o.promise,o._result):(o.length=o.length||0,o._enumerate(),0===o._remaining&&m(o.promise,o._result))):w(o.promise,o._validationError())}function S(t,n){return new Tt(this,t,!0,n).promise}function O(t,n){function e(t){v(i,t)}function r(t){w(i,t)}var o=this,i=new o(f,n);if(!ht(t))return w(i,new TypeError("You must pass an array to race.")),i;for(var u=t.length,a=0;i._state===gt&&a<u;a++)g(o.resolve(t[a]),void 0,e,r);return i}function I(t,n){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var r=new e(f,n);return v(r,t),r}function N(t,n){var e=this,r=new e(f,n);return w(r,t),r}function R(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function M(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function P(t,e){var r=this;r._id=Nt++,r._label=e,r._state=void 0,r._result=void 0,r._subscribers=[],yt.instrument&&wt("created",r),f!==t&&(n(t)||R(),r instanceof P||M(),T(r,t))}function x(t,n,e){this._superConstructor(t,n,!1,e)}function F(t,n){return new x(Rt,t,n).promise}function D(t,n){return Rt.all(t,n)}function Y(t,n){Vt[Dt]=t,Vt[Dt+1]=n,2===(Dt+=2)&&Pt()}function K(){return function(){Mt(q)}}function U(){return function(){setTimeout(q,1)}}function q(){for(var t=0;t<Dt;t+=2){(0,Vt[t])(Vt[t+1]),Vt[t]=void 0,Vt[t+1]=void 0}Dt=0}function G(t){var n={};return n.promise=new Rt(function(t,e){n.resolve=t,n.reject=e},t),n}function L(t,e,r){return Rt.all(t,r).then(function(t){if(!n(e))throw new TypeError("You must pass a function as filter's second argument.");for(var o=t.length,i=new Array(o),u=0;u<o;u++)i[u]=e(t[u]);return Rt.all(i,r).then(function(n){for(var e=new Array(o),r=0,i=0;i<o;i++)n[i]&&(e[r]=t[i],r++);return e.length=r,e})})}function V(t,n,e){this._superConstructor(t,n,!0,e)}function W(t,n,e){this._superConstructor(t,n,!1,e)}function $(t,n){return new W(Rt,t,n).promise}function z(t,n){return new zt(Rt,t,n).promise}function B(t,e,r){return Rt.all(t,r).then(function(t){if(!n(e))throw new TypeError("You must pass a function as map's second argument.");for(var o=t.length,i=new Array(o),u=0;u<o;u++)i[u]=e(t[u]);return Rt.all(i,r)})}function H(){this.value=void 0}function J(t){try{return t.then}catch(t){return Xt.value=t,Xt}}function Q(t,n,e){try{t.apply(n,e)}catch(t){return Xt.value=t,Xt}}function X(t,n){for(var e,r,o={},i=t.length,u=new Array(i),a=0;a<i;a++)u[a]=t[a];for(r=0;r<n.length;r++)e=n[r],o[e]=u[r+1];return o}function Z(t){for(var n=t.length,e=new Array(n-1),r=1;r<n;r++)e[r-1]=t[r];return e}function tt(t,n){return{then:function(e,r){return t.call(n,e,r)}}}function nt(t,n){var e=function(){for(var e,r=this,o=arguments.length,i=new Array(o+1),u=!1,a=0;a<o;++a){if(e=arguments[a],!u){if((u=ot(e))===Zt){var c=new Rt(f);return w(c,Zt.value),c}u&&!0!==u&&(e=tt(u,e))}i[a]=e}var s=new Rt(f);return i[o]=function(t,e){t?w(s,t):void 0===n?v(s,e):!0===n?v(s,Z(arguments)):ht(n)?v(s,X(arguments,n)):v(s,e)},u?rt(s,i,t,r):et(s,i,t,r)};return e.__proto__=t,e}function et(t,n,e,r){var o=Q(e,r,n);return o===Xt&&w(t,o.value),t}function rt(t,n,e,r){return Rt.all(n).then(function(n){var o=Q(e,r,n);return o===Xt&&w(t,o.value),t})}function ot(t){return!(!t||"object"!=typeof t)&&(t.constructor===Rt||J(t))}function it(t,n){return Rt.race(t,n)}function ut(t,n){return Rt.reject(t,n)}function at(t,n){return Rt.resolve(t,n)}function ct(t){throw setTimeout(function(){throw t}),t}function st(t,n){yt.async(t,n)}function ft(){yt.on.apply(yt,arguments)}function lt(){yt.off.apply(yt,arguments)}var pt;pt=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var ht=pt,dt=Date.now||function(){return(new Date).getTime()},_t=Object.create||function(t){if(arguments.length>1)throw new Error("Second argument not supported");if("object"!=typeof t)throw new TypeError("Argument must be an object");return r.prototype=t,new r},vt={mixin:function(t){return t.on=this.on,t.off=this.off,t.trigger=this.trigger,t._promiseCallbacks=void 0,t},on:function(t,n){var e,r=i(this);e=r[t],e||(e=r[t]=[]),-1===o(e,n)&&e.push(n)},off:function(t,n){var e,r,u=i(this);if(!n)return void(u[t]=[]);e=u[t],-1!==(r=o(e,n))&&e.splice(r,1)},trigger:function(t,n){var e,r=i(this);if(e=r[t])for(var o=0;o<e.length;o++)(0,e[o])(n)}},yt={instrument:!1};vt.mixin(yt);var mt=[],wt=c,gt=void 0,bt=1,Et=2,jt=new E,At=new E,Tt=k;k.prototype._validateInput=function(t){return ht(t)},k.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},k.prototype._init=function(){this._result=new Array(this.length)},k.prototype._enumerate=function(){for(var t=this,n=t.length,e=t.promise,r=t._input,o=0;e._state===gt&&o<n;o++)t._eachEntry(r[o],o)},k.prototype._eachEntry=function(t,n){var r=this,o=r._instanceConstructor;e(t)?t.constructor===o&&t._state!==gt?(t._onError=null,r._settledAt(t._state,n,t._result)):r._willSettleAt(o.resolve(t),n):(r._remaining--,r._result[n]=r._makeResult(bt,n,t))},k.prototype._settledAt=function(t,n,e){var r=this,o=r.promise;o._state===gt&&(r._remaining--,r._abortOnReject&&t===Et?w(o,e):r._result[n]=r._makeResult(t,n,e)),0===r._remaining&&m(o,r._result)},k.prototype._makeResult=function(t,n,e){return e},k.prototype._willSettleAt=function(t,n){var e=this;g(t,void 0,function(t){e._settledAt(bt,n,t)},function(t){e._settledAt(Et,n,t)})};var Ct=S,kt=O,St=I,Ot=N,It="rsvp_"+dt()+"-",Nt=0,Rt=P;P.cast=St,P.all=Ct,P.race=kt,P.resolve=St,P.reject=Ot,P.prototype={constructor:P,_guidKey:It,_onError:function(t){yt.async(function(n){setTimeout(function(){n._onError&&yt.trigger("error",t)},0)},this)},then:function(t,n,e){var r=this,o=r._state;if(o===bt&&!t||o===Et&&!n)return yt.instrument&&wt("chained",r,r),r;r._onError=null;var i=new r.constructor(f,e),u=r._result;if(yt.instrument&&wt("chained",r,i),o){var a=arguments[o-1];yt.async(function(){A(o,i,a,u)})}else g(r,i,t,n);return i},catch:function(t,n){return this.then(void 0,t,n)},finally:function(t,n){var e=this,r=e.constructor;return e.then(function(n){return r.resolve(t()).then(function(){return n})},function(n){return r.resolve(t()).then(function(){throw n})},n)}},x.prototype=_t(Tt.prototype),x.prototype._superConstructor=Tt,x.prototype._makeResult=C,x.prototype._validationError=function(){return new Error("allSettled must be called with an array")};var Mt,Pt,xt=F,Ft=D,Dt=0,Yt=Y,Kt="undefined"!=typeof window?window:void 0,Ut=Kt||{},qt=Ut.MutationObserver||Ut.WebKitMutationObserver,Gt="undefined"!=typeof process&&"[object process]"==={}.toString.call(process),Lt="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,Vt=new Array(1e3);Pt=Gt?function(){var t=process.nextTick,n=process.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/);return Array.isArray(n)&&"0"===n[1]&&"10"===n[2]&&(t=setImmediate),function(){t(q)}}():qt?function(){var t=0,n=new qt(q),e=document.createTextNode("");return n.observe(e,{characterData:!0}),function(){e.data=t=++t%2}}():Lt?function(){var t=new MessageChannel;return t.port1.onmessage=q,function(){t.port2.postMessage(0)}}():void 0===Kt&&"function"==typeof require?function(){try{var t=require,n=t("vertx");return Mt=n.runOnLoop||n.runOnContext,K()}catch(t){return U()}}():U();var Wt=G,$t=L,zt=V;V.prototype=_t(Tt.prototype),V.prototype._superConstructor=Tt,V.prototype._init=function(){this._result={}},V.prototype._validateInput=function(t){return t&&"object"==typeof t},V.prototype._validationError=function(){return new Error("Promise.hash must be called with an object")},V.prototype._enumerate=function(){var t=this,n=t.promise,e=t._input,r=[];for(var o in e)n._state===gt&&Object.prototype.hasOwnProperty.call(e,o)&&r.push({position:o,entry:e[o]});var i=r.length;t._remaining=i;for(var u,a=0;n._state===gt&&a<i;a++)u=r[a],t._eachEntry(u.entry,u.position)},W.prototype=_t(zt.prototype),W.prototype._superConstructor=Tt,W.prototype._makeResult=C,W.prototype._validationError=function(){return new Error("hashSettled must be called with an object")};var Bt,Ht=$,Jt=z,Qt=B,Xt=new H,Zt=new H,tn=nt;if("object"==typeof self)Bt=self;else{if("object"!=typeof global)throw new Error("no global: `self` or `global` found");Bt=global}var nn=Bt,en=it,rn=ut,on=at,un=ct;yt.async=Yt;if("undefined"!=typeof window&&"object"==typeof window.__PROMISE_INSTRUMENTATION__){var an=window.__PROMISE_INSTRUMENTATION__;u("instrument",!0);for(var cn in an)an.hasOwnProperty(cn)&&ft(cn,an[cn])}var sn={race:en,Promise:Rt,allSettled:xt,hash:Jt,hashSettled:Ht,denodeify:tn,on:ft,off:lt,map:Qt,filter:$t,resolve:on,reject:rn,all:Ft,rethrow:un,defer:Wt,EventTarget:vt,configure:u,async:st};"function"==typeof define&&define.amd?define("rsvp",[],function(){return sn}):"undefined"!=typeof module&&module.exports?module.exports=sn:void 0!==nn&&(nn.RSVP=sn)}).call(this),define("log",[],function(){return function(t,n){void 0===n&&(n=!0),!0===n&&console.log(t)}}),define("bCheckFile",["rsvp","fs","log"],function(t,n,e){return function(e){return new t.Promise(function(t){n.stat(e,function(n){t(n?!1:!0)})})}}),define("create",["bCheckFile"],function(t){return function(n){var e=this;return new Promise(function(r,o){var i=n,u="test_"+i,a=i+"/"+i+".js",c=i+"/"+u+".js";e.Snip.render({TemplateType:"function",Options:{Name:i},FileName:a}).then(function(){return t(a)}).then(function(t){if(t)return e.Snip.render({TemplateType:"testsuite",Options:{Method:i},FileName:c});o({message:"Code.create - Error: Failed to render the function."})}).then(function(){return t(c)}).then(function(t){if(t)return e.addDependency({FileName:"main.js",Dependency:u,Export:u});o({message:"Code.create - Error: Failed to render the test suite."})}).then(function(t){t?r(e):o({message:"Code.create - Error: Failed to add the dependency to main.js."})}).catch(function(t){o(t)})})}});